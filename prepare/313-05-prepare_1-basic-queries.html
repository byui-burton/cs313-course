<!DOCTYPE html>
<html>

<head>
    <title>Web Engineering II - Preparation</title>
    <link rel="stylesheet" type="text/css" href="../course/style.css" />
</head>

<body>
    <div id="frame"><img src="../course/cs313.png" border="0" alt="Web Engineering II CS 313" title="Web Engineering II CS 313" width="100%" />
        <div id="content">



        <h1>Part One<br />Basic Queries In MySQL</h1>
        <h2>Objective</h2>
        <p>This document covers the basics of retrieving, or querying, data from a MySQL database.</p>
        <h2>Guidelines</h2>
        <p>Before we can retrieve data from the database, we need to create some tables and insert data into them. For this example we will create two tables: a user table containing an id, a username, and a password; and a notes table containing an id, the userId of the user that created it, and the content of the note.</p>
        <h3>Step 1: Creating Tables</h3>
        <p>Recall from our previous discussion, that these tables can be created with the following commands:</p>
        <p class="cd">CREATE TABLE user (
            <br />&nbsp; id int NOT NULL AUTO_INCREMENT,
            <br />&nbsp; username varchar(50),
            <br />&nbsp; password varchar(50),
            <br />&nbsp; PRIMARY KEY (id)
            <br />);</p>
        <p>and</p>
        <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">CREATE TABLE note (<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; id int NOT NULL AUTO_INCREMENT,<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; userId int NOT NULL,<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; content blob,<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; PRIMARY KEY (id),<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; FOREIGN KEY (userId) REFERENCES user (id)<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">);</span></p>
        <div>
            <p dir="ltr"><b><span style="font-family: verdana, geneva; font-size: 12pt;">Step 2: Inserting Data</span></b></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">To insert data into these tables, we use the following syntax:</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">INSERT INTO tableName (column1, column2, etc.) VALUES (value1, value2, etc.);</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Note that the specification of column names is not technically required, but it enables us to specify each specific one for which we are passing data and in what order.</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Thus, to insert data into the user table, we can run the following commands:</span></p>
            <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">INSERT INTO user (username, password) VALUES ('john', 'pass');<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">INSERT INTO user (username, password) VALUES ('jane', 'byui');</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Note that we do not have to specify the id column for these rows because we have set it to auto-increment, so it will automatically be assigned the next integer value.</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Similarly, we can insert notes into the notes table as follows. These lines create two notes for the user john, and one for the user jane.</span></p>
            <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">INSERT INTO note (userId, content) VALUES (1, 'A note for John');<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">INSERT INTO note (userId, content) VALUES (1, 'Another note for John');<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">INSERT INTO note (userId, content) VALUES (2, 'And this is a note for Jane');</span></p><span style="font-family: verdana, geneva; font-size: 12pt;"></span>
            <p dir="ltr"><b><span style="font-family: verdana, geneva; font-size: 12pt;">Step 3: Retrieving Data</span></b></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">At this point, we have two tables in our database, and we have inserted data into them. Now we need to discover how to retrieve the data from these tables. This is done using the SELECT statement as follows, which in its most basic form is:</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">SELECT columnNames FROM tableName;</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">To select all rows from the user table, and display every column, we can use the following command:</span></p>
            <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">SELECT * FROM user;</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Note that the *&nbsp;operator will select all columns.</span></p>
            <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Running this command in MySQL returns the following:</span></p><span style="font-family: verdana, geneva; font-size: 12pt;"></span>
            <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT * FROM user;<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| id | username | password |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;1 | john &nbsp;&nbsp;&nbsp;&nbsp;| pass &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;2 | jane &nbsp;&nbsp;&nbsp;&nbsp;| byui &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">2 rows in set (0.00 sec)</span></p><span style="font-family: verdana, geneva; font-size: 12pt;"></span>
            <div><span style="font-family: verdana, geneva; font-size: 12pt;"><span style="font-family: verdana, geneva; font-size: 12pt;"></span></span>
                <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">If we only want to receive certain columns, or specify a different order for the columns, we can list specific column names, rather than using the *, as follows:</span></p>
                <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT username FROM user;<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| username |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| john &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| jane &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">2 rows in set (0.00 sec)</span></p>
                <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT password, username FROM user;<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| password | username |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| pass &nbsp;&nbsp;&nbsp;&nbsp;| john &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| byui &nbsp;&nbsp;&nbsp;&nbsp;| jane &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">2 rows in set (0.00 sec)</span></p><span style="font-family: verdana, geneva; font-size: 12pt;"><span style="font-family: verdana, geneva; font-size: 12pt;"></span></span>
                <div><span style="font-family: verdana, geneva; font-size: 12pt;">Notice that in each of these cases we are returning all rows from the table. If we want to restrict the rows that are returned, we add a &ldquo;WHERE clause&rdquo; at the end of our statement like so:</span>
                    <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">SELECT columnNames FROM tableName WHERE conditions;</span></p>
                    <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">For example:</span></p><span style="background-color: #ededed;"><span style="background-color: #ededed;"><span><span><span></span></span>
                    </span>
                    </span>
                    </span>
                    <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT * FROM user WHERE username = 'John';<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| id | username | password |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;1 | john &nbsp;&nbsp;&nbsp;&nbsp;| pass &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">1 row in set (0.00 sec)</span></p>
                    <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT * FROM user WHERE id &gt; 1;<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| id | username | password |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;2 | jane &nbsp;&nbsp;&nbsp;&nbsp;| byui &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">1 row in set (0.00 sec)</span></p>
                    <p dir="ltr"><span style="font-size: 12pt; font-family: verdana, geneva;">Another clause that can be added to a query after the optional &ldquo;where clause&rdquo; is an &ldquo;order by clause&rdquo;:</span></p>
                    <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT * FROM user ORDER BY username;<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| id | username | password |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;2 | jane &nbsp;&nbsp;&nbsp;&nbsp;| byui &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;1 | john &nbsp;&nbsp;&nbsp;&nbsp;| pass &nbsp;&nbsp;&nbsp;&nbsp;|</span><span style="background-color: #ededed;"><span style="font-family: 'courier new', courier; font-size: 12pt;"><br /></span></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">2 rows in set (0.01 sec)</span><span style="background-color: #ededed;"><span style="font-family: 'courier new', courier; font-size: 12pt;"><br /></span></span>
                    </p>
                    <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT * FROM user ORDER BY username DESC;</span><span style="background-color: #ededed;"><span style="font-family: 'courier new', courier; font-size: 12pt;"><br /></span></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| id | username | password |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;1 | john &nbsp;&nbsp;&nbsp;&nbsp;| pass &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;2 | jane &nbsp;&nbsp;&nbsp;&nbsp;| byui &nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">2 rows in set (0.00 sec)</span></p>
                    <p dir="ltr"><span style="font-family: verdana, geneva;">Notice in the first example, the rows are ordered by the username, and in the second, they are ordered by username in descending fashion (DESC).</span></p>
                    <p dir="ltr"><span style="background-color: #ededed;"><b><span style="font-family: verdana, geneva; font-size: 12pt;">Step 4. Joining Tables</span></b>
                        </span>
                    </p>
                    <div>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Using the same format as before, we could select all the notes from the note table:</span></p>
                        <p dir="ltr"><span style="font-family: 'courier new', courier;">mysql&gt; SELECT * FROM note;<br /></span><span style="font-family: 'courier new', courier;">+----+--------+-----------------------------+<br /></span><span style="font-family: 'courier new', courier;">| id | userId | content &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier;">+----+--------+-----------------------------+<br /></span><span style="font-family: 'courier new', courier;">| &nbsp;1 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 | A note for John &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier;">| &nbsp;2 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 | Another note for John &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier;">| &nbsp;3 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 | And this is a note for Jane |<br /></span><span style="font-family: 'courier new', courier;">+----+--------+-----------------------------+<br /></span><span style="font-family: 'courier new', courier;">3 rows in set (0.00 sec)</span></p><span><span><span><span><span></span></span>
                        </span>
                        </span>
                        </span>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">But suppose we only wanted the notes for the user &lsquo;john.&rsquo;&nbsp;We could add a where clause to our query like so:</span></p><span><span><span><span><span></span></span>
                        </span>
                        </span>
                        </span>
                        <p dir="ltr"><span style="font-family: 'courier new', courier;">mysql&gt; SELECT * FROM note where userID = 1;</span></p>
                        <p dir="ltr"><span style="font-family: 'courier new', courier;">+----+--------+-----------------------+<br /></span><span style="font-family: 'courier new', courier;">| id | userId | content &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier;">+----+--------+-----------------------+<br /></span><span style="font-family: 'courier new', courier;">| &nbsp;1 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 | A note for John &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier;">| &nbsp;2 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 | Another note for John |<br /></span><span style="font-family: 'courier new', courier;">+----+--------+-----------------------+<br /></span><span style="font-family: 'courier new', courier;">2 rows in set (0.00 sec)</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">But this requires us to first find out John's userId, if we only know his username. A better approach is to &ldquo;join&rdquo; the tables together on the matching column (in this case userId) to temporarily make one big table that has the user information and the note information in it. Then we can use the username in the where clause. The syntax of joining tables is as follows:</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva;">SELECT columns<br /></span><span style="font-family: verdana, geneva;">FROM table1<br /></span><span style="font-family: verdana, geneva;">JOIN table2<br /></span><span style="font-family: verdana, geneva;">ON columnFromTable1 = columnFromTable2;</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva;">Then we can of course add other clauses afterward. While this works because these two tables may have columns with the same names, it is useful to give them aliases so that we can say which table we mean, as follows:</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">SELECT columns<br /></span><span style="background-color: #ededed;"><span style="font-family: verdana, geneva; font-size: 12pt;">FROM table1 AS t1<br /></span><span style="font-family: verdana, geneva; font-size: 12pt;">JOIN table2 AS t2<br /></span><span style="font-family: verdana, geneva; font-size: 12pt;">ON t1.column = t2.column;</span></span>
                        </p>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">The aliases t1, and t2 can then be used in other places in the query such as the columns that will be selected. Using the join syntax, we can join the user and note table together and return all rows and all columns from the big temporary table:</span></p>
                        <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT * FROM user AS u<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; &nbsp; -&gt; JOIN note AS n<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; &nbsp; -&gt; ON u.id = n.userId;<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+----+--------+-----------------------------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| id | username | password | id | userId | content &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+----+--------+-----------------------------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;1 | john &nbsp;&nbsp;&nbsp;&nbsp;| pass &nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;1 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 | A note for John &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;1 | john &nbsp;&nbsp;&nbsp;&nbsp;| pass &nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;2 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 | Another note for John &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| &nbsp;2 | jane &nbsp;&nbsp;&nbsp;&nbsp;| byui &nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;3 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 | And this is a note for Jane |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+----+----------+----------+----+--------+-----------------------------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">3 rows in set (0.01 sec)</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">You can see that all columns and rows from both tables are present, and that data such as John's username has been repeated wherever required.</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Using this syntax, a more useful query could be to return all of John's notes:</span></p>
                        <p dir="ltr"><span style="font-family: 'courier new', courier; font-size: 12pt;">mysql&gt; SELECT n.content FROM user AS u<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; &nbsp; -&gt; JOIN note AS n<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; &nbsp; -&gt; ON u.id = n.userId<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">&nbsp; &nbsp; -&gt; WHERE u.username = 'john';</span><span style="background-color: #ededed;"><span style="font-family: 'courier new', courier; font-size: 12pt;"><br /></span></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+-----------------------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| content &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+-----------------------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| A note for John &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">| Another note for John |<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">+-----------------------+<br /></span><span style="font-family: 'courier new', courier; font-size: 12pt;">2 rows in set (0.00 sec)</span></p>
                        <p dir="ltr"><span style="font-family: verdana, geneva; font-size: 12pt;">Notice that in this example, we have specified that we only want to see the content column from the note table (n.content), and that we want to restrict the data to only those rows where the username column from the user table (u.username) is equal to &lsquo;john.&rsquo;</span></p>
                        <div><span>&nbsp;</span></div>
                    </div>
                </div>
            </div>
        </div>





        </div>
    </div>


</body>

</html>